## 三次握手四次挥手
- https://blog.csdn.net/dreamispossible/article/details/91345391

### 三次握手的过程
- 刚开始客户端处于 closed 的状态，服务端处于 listen 状态。然后
1. 第一次握手：客户端给服务端发一个 SYN 报文，并指明客户端的初始化序列号 ISN（c）。此时客户端处于 SYN_Send 状态。
2. 第二次握手：服务端收到客户端的 SYN 报文之后，以自己的 SYN 报文作为应答，并且指定自己的初始化序列号 ISN(s)，同时把客户端的 ISN + 1 作为 ACK 的值，表示自己已经收到客户端的 SYN，此时服务端处于 SYN_REVD 的状态。
3. 第三次握手：客户端收到 SYN 报文后，把服务端的 ISN + 1 作为 ACK 的值，发送一个 ACK 报文，表示已经收到了服务端的 SYN 报文，此时客户端处于 establised 状态。
4. 服务端收到 ACK 报文之后，也处于 establised 状态，此时，双方建立起链接。

### 三次握手的作用
- 确认双方的接受能力、发送能力是否正常。
- 指定自己的初始化序列号，为后面的可靠传送做准备。
- 如果是 https 协议的话，三次握手这个过程，还会进行数字证书的验证以及加密密钥的生成。

### 四次挥手的过程
- 刚开始双方都处于 establised 状态，假如是客户端先发起关闭请求，则：
1. 第一次挥手：客户端发送一个 FIN 报文，报文中会指定一个序列号。此时客户端处于FIN_WAIT1状态。
2. 第二次挥手：服务端收到 FIN 之后，会发送 ACK 报文，且把客户端的序列号值 + 1 作为 ACK 报文的序列号值，表明已经收到客户端的报文了，此时服务端处于 CLOSE_WAIT状态。
3. 第三次挥手：如果服务端也想断开连接，会发送一个 FIN 报文，且指定一个序列号。此时服务端处于 LAST_ACK 的状态。
4. 第四次挥手：客户端收到 FIN 之后，发送一个 ACK 报文作为应答，且把服务端的序列号值 + 1 作为自己 ACK 报文的序列号值，此时客户端处于 TIME_WAIT 状态。需要过一阵子以确保服务端收到自己的 ACK 报文之后才会进入 CLOSED 状态
5. 服务端收到 ACK 报文之后，进入 CLOSED 状态，关闭连接。

FIN_WAIT1
CLOSE_WAIT
LAST_ACK
TIME_WAIT